function Character(n,t,i){return _englishString=n,_shiftKey=t,_Index=i,{englishString:_englishString,shiftKey:_shiftKey,index:_Index}}function jGeezAttributes(){return{enabled:{name:"jgeez-enabled",value:!0},englishbutton:{name:"jgeez-englishbutton",value:""},geezbutton:{name:"jgeez-geezbutton",value:""},showtogglebutton:{name:"jgeez-showtogglebutton",value:!0},helpbutton:{name:"jgeez-helpbutton",value:""},showhelpbutton:{name:"jgeez-showhelpbutton",value:!0},toggleshortcut:{name:"jgeez-toggleshortcut",value:"q"},font:{name:"jgeez-font",value:"jiret"}}}var JGeezUtility={isModifier:function(n){for(mod in JGeezUtility.UNICODEModifierMatrix)if(n==JGeezUtility.UNICODEModifierMatrix[mod][0])return!0;return!1},UNICODE:function(n){var t,r;_root=n.englishString.substr(0,1),_modifier=n.englishString.substr(1,1),_shift=n.shiftKey,_caps=_shift&&_root.charCodeAt(0)>96||!_shift&&_root.charCodeAt(0)<=96,_matches=Array(),_rootlower=_root.toLowerCase();for(i in JGeezUtility.UNICODEMatrix)_resemblence=100,_currentunicode=JGeezUtility.UNICODEMatrix[i],_currentunicode[1].toLowerCase()==_rootlower&&(_currentunicode[1]!=_root&&(_resemblence-=20),_currentunicode[2]!=null&&(_resemblence-=5),_currentunicode[2]==_shift&&(_resemblence+=7),_currentunicode[3]!=null&&(_resemblence-=5),_currentunicode[3]==_caps&&(_resemblence+=7),_matches.push({index:i,resemblence:_resemblence,unicode:_currentunicode[0]}));for(_m in _matches)t?_matches[_m].resemblence>t.resemblence&&(t=_matches[_m]):t=_matches[_m];if(t&&(r=t.unicode),r&&_modifier)for(mod in JGeezUtility.UNICODEModifierMatrix)JGeezUtility.UNICODEModifierMatrix[mod][0]==_modifier&&(r=r+JGeezUtility.UNICODEModifierMatrix[mod][1]);return r?String.fromCharCode(r):_root},cIdx:"c_Ch",aIdx:"a_Ch",Print:{isPrintable:function(n){return n>=65&&n<=90||n>=97&&n<=122},newCharacter:function(n,t){rightstr=t.attr("value").substr(0,n.index),leftstr="",n.index<t.attr("value").length&&(leftstr=t.attr("value").substr(n.index,t.attr("value").length-n.index)),t.attr("value",rightstr+JGeezUtility.UNICODE(n)+leftstr),JGeezUtility.Caret.setPosition(t,n.index+1)},replaceCharacter:function(n,t){rightstr=t.attr("value").substr(n.index+1),leftstr="",n.index<t.attr("value").length&&(leftstr=t.attr("value").substr(0,n.index)),t.attr("value",leftstr+JGeezUtility.UNICODE(n)+rightstr),JGeezUtility.Caret.setPosition(t,n.index+1)}},Caret:{getPosition:function(n){var t=0,i;return n=n[0],document.selection?(n.focus(),i=document.selection.createRange(),i.moveStart("character",-n.value.length),t=i.text.length):(n.selectionStart||n.selectionStart=="0")&&(t=n.selectionStart),t},setPosition:function(n,t){if(n=n[0],n.setSelectionRange)n.focus(),n.setSelectionRange(t,t);else if(n.createTextRange){var i=n.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",t),i.select()}}},hasGeezFont:!1,instances:[],bindEvents:function(){for(o in JGeezUtility.instances)if(target=$(":[jgeez-index="+o+"]"),!target.data("jgeez-event")){options=JGeezUtility.instances[o];for(e in options.eventHandlers)options.eventHandlers[e].element.on(options.eventHandlers[e].event,options.eventHandlers[e].data,options.eventHandlers[e].handler);target.data("jgeez-event",{})}}},jGeezLibraryAttributes;(function(n){n.fn.jGeez=function(i){if(t[i])return t[i].apply(this,Array.prototype.slice.call(arguments,1));if(typeof i!="object"&&i)n.error("Method "+i+" does not exist on jQuery.jGeez");else return t.init.apply(this,arguments)};var t={changeoptions:function(t){_options=JGeezUtility.instances[n(this).attr("jgeez-index")],_options=n.extend(_options,t),n(this).data("jGeez",_options)},reattachevents:function(){if(options=JGeezUtility.instances[n(this).attr("jgeez-index")],!n(this).data("jgeez-event")){for(e in options.eventHandlers)options.eventHandlers[e].element.on(options.eventHandlers[e].event,options.eventHandlers[e].data,options.eventHandlers[e].handler);n(this).data("jgeez-event",{})}},init:function(t){function i(t){_options=JGeezUtility.instances[t.attr("jgeez-index")],__gbtn=n("#"+_options.geezbutton),__ebtn=n("#"+_options.englishbutton),_options.enabled=!_options.enabled,__ebtn&&__gbtn&&(_options.enabled?(__ebtn.show(),__gbtn.hide()):(__ebtn.hide(),__gbtn.show()))}var t=n.extend({showhelpbutton:!0,showtogglebutton:!0,enabled:!0,geezbutton:"",englishbutton:"",helpbutton:"",toggleshortcut:"q"},t);t.eventHandlers=[],n(this).attr("jgeez-index",JGeezUtility.instances.length),JGeezUtility.instances.push(t),t.showhelpbutton&&(_help=n("#"+t.helpbutton),_help.attr("href","http://jgeez.com/home/help"),_help.attr("target","_blank")),t.geezbutton&&t.englishbutton&&(_gbtn=n("#"+t.geezbutton),_ebtn=n("#"+t.englishbutton),_gbtn.length>0&&_ebtn.length>0&&(t.eventHandlers.push({element:_ebtn,event:"click",data:{txtbox:n(this)},handler:function(n){i(n.data.txtbox),n.data.txtbox.focus()}}),t.eventHandlers.push({element:_gbtn,event:"click",data:{txtbox:n(this)},handler:function(n){i(n.data.txtbox),n.data.txtbox.focus()}}),t.showtogglebutton?t.enabled?(_gbtn.hide(),_ebtn.show()):(_gbtn.show(),_ebtn.hide()):(_ebtn.hide(),_gbtn.hide()))),t.eventHandlers.push({element:n(this),event:"keyup",handler:function(t){_options=JGeezUtility.instances[n(this).attr("jgeez-index")],(t.altKey||t.ctrlKey||!JGeezUtility.Print.isPrintable(t.which))&&String.fromCharCode(t.which).toLowerCase()==_options.toggleshortcut.toLowerCase()&&i(n(this))}}),t.eventHandlers.push({element:n(this),event:"keypress",handler:function(t){var i,r;if(_options=JGeezUtility.instances[n(this).attr("jgeez-index")],t.altKey||t.ctrlKey||!JGeezUtility.Print.isPrintable(t.which))n(this).data(JGeezUtility.aIdx,null);else{if(!_options.enabled)return;i=Character(String.fromCharCode(t.which),t.shiftKey,JGeezUtility.Caret.getPosition(n(this))),n(this).data(JGeezUtility.cIdx,i),r=n(this).data(JGeezUtility.aIdx),r&&r.index+1==i.index?JGeezUtility.isModifier(i.englishString)?(r.englishString+=i.englishString,JGeezUtility.Print.replaceCharacter(r,n(this)),n(this).data(JGeezUtility.aIdx,null)):(r=Character(i.englishString,i.shiftKey,i.index),n(this).data(JGeezUtility.aIdx,r),JGeezUtility.Print.newCharacter(r,n(this))):(r=Character(i.englishString,i.shiftKey,i.index),n(this).data(JGeezUtility.aIdx,r),JGeezUtility.Print.newCharacter(r,n(this))),t.preventDefault()}}});for(e in t.eventHandlers)t.eventHandlers[e].element.on(t.eventHandlers[e].event,t.eventHandlers[e].data,t.eventHandlers[e].handler);n(this).data("jgeez-event",{})}}})(jQuery),JGeezUtility.UNICODEModifierMatrix=[["a",3],["e",5],["i",2],["o",6],["u",1],["y",4],["A",3],["E",5],["I",2],["O",6],["U",1]],JGeezUtility.UNICODEMatrix=[[4608,"h"],[4616,"l"],[4624,"H",!0],[4632,"m"],[4640,"s",!0,!0],[4648,"r"],[4656,"s"],[4664,"S"],[4672,"q"],[4682,"Q"],[4704,"b"],[4712,"v"],[4720,"t"],[4728,"c"],[4736,"h",!0,!0],[4752,"n"],[4760,"N"],[4768,"x"],[4776,"k"],[4792,"h",!0],[4808,"w"],[4816,"x"],[4824,"z"],[4832,"Z"],[4840,"Y"],[4848,"d"],[4856,"P"],[4864,"j"],[4872,"g"],[4896,"T"],[4904,"C"],[4920,"t",!0,!0],[4928,"T",!1,!0],[4936,"f"],[4944,"P"],[4768,"a"],[4769,"u"],[4770,"i"],[4772,"e"],[4774,"o"],[4840,"y"]],jGeezLibraryAttributes={mode:{auto:"auto",manual:"manual"}},$(document).ready(function(){var n,t,i;_scriptheader=$("script[src*='jgeez']"),_mode=_scriptheader.attr("mode"),n=jGeezAttributes(),t=Math.floor(Math.random()*1e3+1),$("body").append('<span id="s'+t+'" style="width:10px; font-size:30px;overflow:visible;">ሀ<\/span'),$("body").append('<span id="s'+(t+1)+'" style="width:10px; font-size:30px;overflow:visible;">መ<\/span'),_font=_scriptheader.attr(n.font.name),($("#s"+t).width()==$("#s"+(t+1)).width()||_font)&&(_font||(_font=n.font.value),$("<link>").appendTo($("head")).attr({type:"text/css",rel:"stylesheet"}).attr("href","http://www.jgeez.com/cdn/styles/"+_font+"/style.css")),$("#s"+t).remove(),$("#s"+(t+1)).remove(),$("body").ajaxComplete(function(){JGeezUtility.bindEvents()}),_mode==jGeezLibraryAttributes.mode.auto&&(i={padding:"0px 6px","font-weight":"bold",cursor:"pointer","margin-left":"1px","text-decoration":"none"},_geezinputs=$("[jgeez-enabled='true']"),_geezinputs.length==0&&(_geezinputs=$("input,textarea")),_geezinputs.each(function(){var r,u,f;(n=jGeezAttributes(),$(this).is("["+n.enabled.name+"]")&&(n.enabled.value=$(this).attr(n.enabled.name)=="true"),$(this).is("["+n.englishbutton.name+"]")&&(n.englishbutton.value=$(this).attr(n.englishbutton.name)),$(this).is("["+n.geezbutton.name+"]")&&(n.geezbutton.value=$(this).attr(n.geezbutton.name)),$(this).is("["+n.showtogglebutton.name+"]")&&(n.showtogglebutton.value=$(this).attr(n.showtogglebutton.name)=="true"),$(this).is("["+n.helpbutton.name+"]")&&(n.helpbutton.value=$(this).attr(n.helpbutton.name)),$(this).is("["+n.showhelpbutton.name+"]")&&(n.showhelpbutton.value=$(this).attr(n.showhelpbutton.name)=="true"),$(this).is("["+n.toggleshortcut.name+"]")&&(n.toggleshortcut.value=$(this).attr(n.toggleshortcut.name)),n.enabled&&(!$(this).is("input")||$(this).attr("type")==undefined||$(this).attr("type")=="text"))&&(n.showhelpbutton.value&&(n.helpbutton.value&&(r=$("#"+n.helpbutton.value)),r||(r=$("<a><\/a>"),r.attr("id","geezhelp_"+t++),r.css(i),r.css({"background-image":"url(../Content/themes/base/images/helpsmall.png)"}),r.html("&nbsp"),r.insertAfter($(this)),$(this).is("textarea")&&r.css({"vertical-align":"top"})),n.helpbutton.value=r.attr("id")),n.showtogglebutton.value&&(n.englishbutton.value&&(u=$("#"+n.englishbutton.value)),u||(u=$("<a><\/a>"),u.attr("id","englishtoggle_"+t++),u.css(i),u.css({"background-image":"url(http://jgeez.com/Samples/Images/united_kindom.png)"}),u.html("&nbsp"),u.insertAfter($(this)),$(this).is("textarea")&&u.css({"vertical-align":"top"})),n.geezbutton.value&&(f=$("#"+n.geezbutton.value)),f||(f=$("<a><\/a>"),f.attr("id","geeztoggle_"+t++),f.css(i),f.css({"background-image":"url(http://jgeez.com/Samples/Images/ethiopia_flag.png)"}),f.html("&nbsp"),f.insertAfter($(this)),$(this).is("textarea")&&f.css({"vertical-align":"top"})),n.englishbutton.value=u.attr("id"),n.geezbutton.value=f.attr("id")),$(this).jGeez({englishbutton:n.englishbutton.value,geezbutton:n.geezbutton.value,showtogglebutton:n.showtogglebutton.value,helpbutton:n.helpbutton.value,showhelpbutton:n.showhelpbutton.value,toggleshortcut:n.toggleshortcut.value}))}))})